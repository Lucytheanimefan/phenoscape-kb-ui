<h2>Semantic Similarity</h2>
<p>Submit a gene, get back taxa!</p>
<div class="panel-body">
  <form role="form">
      <div>
          <h4>Gene:</h4>
          <div class="form-group" ng-class="{'has-success': geneToQuery, 'has-feedback': geneToQuery}">
              <input type="text" ng-model="geneToQuery" placeholder="any gene symbol" typeahead="gene as (gene.label + ' (' + gene.taxon.label + ')') for gene in searchGenes($viewValue)" typeahead-loading="loadingGeneComplete" typeahead-wait-ms="300" typeahead-editable="false" class="form-control">
              <span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true" ng-show="geneToQuery"></span>
              <i ng-show="loadingGeneComplete" class="glyphicon glyphicon-refresh"></i>
          </div>
      </div>
  </form>
  <div class="row" ng-show="geneToQuery">
      <h4>Evolutionary profiles matching gene <b>{{geneToQuery.label}}</b> ({{geneToQuery.taxon.label}})</h4>
      <div class="col-sm-4">
          <table class="table table-condensed" cg-busy="topMatches.$promise">
              <thead>
                  <tr>
                      <th>Taxon</th>
                      <th>Score</th>
                      <th></th>
                  </tr>
              </thead>
              <tbody>
                  <tr ng-repeat="match in topMatches.results" ng-click="selectMatch(match);" ng-class="{'info': (match === selectedMatch), 'active': hover}" ng-mouseenter="hover = true" ng-mouseleave="hover = false">
                      <td><a href="{{match.match_profile['@id']}}" target="_blank">{{match.match_profile.label}}</a></td>
                      <td>{{match.score | number : 2}}</td>
                      <td><span ng-show="hover || (match === selectedMatch)">âž </span></td>
                  </tr>
              </tbody>
          </table>
          <pagination total-items="matchesTotal.total" ng-model="matchesPage" max-size="maxSize" class="pagination-sm" boundary-links="true" rotate="false"  items-per-page="matchesLimit" cg-busy="matchesTotal.$promise" ng-change="pageChanged()"></pagination>
      </div>
      <div class="col-sm-8">
          <div ng-hide="selectedMatch" class="well"><h2 class="text-center"><i class="small">Click on any row to the left to view detailed results</i></h2></div>
          <div class="panel panel-default" style="margin-top: 1em;" ng-show="selectedMatch">
            <div class="panel-heading"><h4 class="panel-title">Match details</h4></div>
            <div class="panel-body">
                <h5>Query gene: {{geneToQuery.label}} ({{geneToQuery.taxon.label}}) <small>{{queryProfileSize.total}} phenotypes</small></h5>
                <h5>Matched taxon: {{selectedMatch.match_profile.label}} <small><a href="#/query_variation_profile?taxa={{[selectedMatch.match_profile['@id']] | json | encodeURI}}">{{selectedMatchProfileSize.total}} phenotypes</a></small></h5>
            </div>
            <table class="table table-condensed table-striped" cg-busy="annotationMatches.$promise">
                <thead>
                    <tr>
                        <th>Gene Phenotype</th>
                        <th>Taxon Phenotype</th>
                        <th>Match Information Content</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="match in annotationMatches.results">
                        <td>
                            <a title="{{match.query_annotation['@id']}}">{{match.query_annotation.label}}</a>
                        </td>
                        <td>
                            <a title="{{match.corpus_annotation['@id']}}">{{match.corpus_annotation.label}}</a>
                        </td>
                        <td class="text-center" title="{{match.best_subsumer.term.label}}">{{match.best_subsumer.ic | number : 2}} <button ng-show="match.best_subsumer.disparity > 0.15" type="button" class="btn btn-warning btn-xs">IC warning</button></td>
                   </tr>
                </tbody>
            </table>
          </div>
      </div>
    </div>
</div>


